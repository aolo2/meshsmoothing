========= 08.03.20. Baseline (-O2) ============
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 11.734375 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 20.326822 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 40.531250 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 144.376785 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 567.845032 usec/v

traces/cubic_torus_5.tracy
===============================================


========= 09.03.20. Indexed vertices (-O2) ====
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 1.937500 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 1.773438 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 4.409180 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 15.554606 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 59.815552 usec/v

traces/INDEXED_cubic_torus_5.tracy
===============================================


========= 09.03.20. Separate chaining table (-O2)
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.531250 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.416667 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 0.359049 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 0.159180 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 0.144491 usec/v

[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 0.173579 usec/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 0.208380 usec/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 0.219517 usec/v

traces/HASHSC_cubic_torus_5.tracy
===============================================


========= 10.03.20. Locality sensitive hashing (-O2)
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.947917 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.742188 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 0.593099 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 0.245443 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 0.233439 usec/v

traces/LSH_cubic_torus_5.tracy
===============================================


========= 18.03.20. Explicit ajdacency info (-O2)
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.463542 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.346354 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 0.299479 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 0.250651 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 0.118510 usec/v

[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 0.133586 usec/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 0.139140 usec/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 0.144132 usec/v

traces/EXPLICIT_cubic_torus_5.tracy
===============================================


[[[[======= 14.04.20 Working on edge points ====]]]]]


simplify edge points table somehow... (found many DC misses via uProf)
remove ms_vecs everywhere (found many samples)





========= 15.04.20. Edge sort (-O2)
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.120000 msec, 0.625000 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.323000 msec, 0.420573 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 1.210000 msec, 0.393880 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 4.896000 msec, 0.398438 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 13.337000 msec, 0.271342 usec/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 36.897999 msec, 0.187673 usec/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 168.087997 msec, 0.213735 usec/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 755.658020 msec, 0.240217 usec/v
===============================================

========== 15.04.20 Edges binned by start (try to remove cache misses caused by vectors) ====
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.084000 msec, 0.437500 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.215000 msec, 0.279948 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 0.685000 msec, 0.222982 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 2.840000 msec, 0.231120 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 8.861000 msec, 0.180278 usec/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 22.534000 msec, 0.114614 usec/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 95.678001 msec, 0.121661 usec/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 410.333008 msec, 0.130441 usec/v


uprof params: res/cube_hole.obj_8.obj 3
IBS DC miss 6700 (old) -> 5000 (new)
===============================================

forgot to add early-out on edge points table construction >.<

===
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.066000 msec, 0.343750 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.160000 msec, 0.208333 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 0.539000 msec, 0.175456 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 2.104000 msec, 0.171224 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 5.228000 msec, 0.106364 usec/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 19.131001 msec, 0.097305 usec/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 83.037003 msec, 0.105587 usec/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 394.186005 msec, 0.125308 usec/v
===

now lets try to fix the csr construction (get rid of vectors)

=== (try to remove move cache misses caused by vectors)
[INFO] Loaded OBJ file: res/cubic_torus.obj
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.056000 msec, 0.291667 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.157000 msec, 0.204427 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 0.379000 msec, 0.123372 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 1.442000 msec, 0.117350 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 6.363000 msec, 0.129456 usec/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 15.557000 msec, 0.079127 usec/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 65.281998 msec, 0.083010 usec/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 319.458008 msec, 0.101553 usec/v

uprof params: res/cube_hole.obj_8.obj 3
IBS DC miss 5000 (old) -> 2615 (new)
===


===
do not returns ms_vec's from vert_adjacent_xxx

[INFO] Loading OBJ file: res/cubic_torus.obj...
[INFO] Loaded OBJ file: res/cubic_torus.obj.
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 0.064000 msec, 0.333333 usec/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 0.147000 msec, 0.191406 usec/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 0.417000 msec, 0.135742 usec/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 1.584000 msec, 0.128906 usec/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 6.458000 msec, 0.131388 usec/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 12.155000 msec, 0.061824 usec/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 64.042000 msec, 0.081434 usec/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 309.907013 msec, 0.098517 usec/v
===



----- switch to cycles per vertex (with rdtsc) -----
005dd548e79fa86ce68c570116cd995f19ab7fe4 (old CSR)
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 2307695456 cycles, 733.596619 cycles/v

a937297c2b58f227038df21c1621d6b9676f5d94 (edge binning)
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 1267254528 cycles, 402.849365 cycles/v

5f3f66e0bdb0ba7d16d7d2e777923e7a5e5f0c75 (ms_vecs + cleanup)
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 1023658720 cycles, 325.412354 cycles/v
-----


-- tigth packing of adjacency CSR --
./build/profile/ms res/cubic_torus.obj_7.obj 1
with:
	- init acceleration struct = 112ms
	- edge points = 153ms
	- update old points = 40ms
~305 cycles/v
without:
	- init acceleration struct = 107ms
	- edge points = 167ms
	- update old points = 42s
~315 cycles/v
----


--- use adjacency info for faster edge points
[INFO] Loading OBJ file: res/cubic_torus.obj...
[INFO] Loaded OBJ file: res/cubic_torus.obj.
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 227616 cycles, 1185.500000 cycles/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 601984 cycles, 783.833313 cycles/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 1711520 cycles, 557.135437 cycles/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 6318240 cycles, 514.179688 cycles/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 26809440 cycles, 545.439453 cycles/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 64780672 cycles, 329.491547 cycles/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 223465344 cycles, 284.150879 cycles/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 855525184 cycles, 271.964142 cycles/v
---

-- save face info per edge and use it instead of edge_adjacent_face ---
[INFO] Loading OBJ file: res/cubic_torus.obj...
[INFO] Loaded OBJ file: res/cubic_torus.obj.
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 246848 cycles, 1285.666626 cycles/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 587776 cycles, 765.333313 cycles/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 1789152 cycles, 582.406250 cycles/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 6698912 cycles, 545.158875 cycles/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 29922496 cycles, 608.774719 cycles/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 48483808 cycles, 246.601395 cycles/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 193588800 cycles, 246.160889 cycles/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 805827360 cycles, 256.165619 cycles/v
---

curiously, 20cycles/vertex speedup for replacing in edge points, but gets worse
when replacing hole point updates


debug mode uProf run revealed that
if (accel.verts_matrix_repeats[e3] == end && adj_face != face) has BR misp = 70.46%

!!! wow this works !!!
rearranged the if and got down to
screenshots of uProf in VK
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 779098816 cycles, 247.668839 cycles/v
~~


~~~ added omp parallel for (no args) to face points and update points
cubic_torus.obj 8
with:
	- face points = 3.7ms
	- update points = 15ms
without:
	- face points = 5ms
	- update points = 29ms


[INFO] Loading OBJ file: res/cubic_torus.obj...
[INFO] Loaded OBJ file: res/cubic_torus.obj.
[INFO] Finished Catmull-Clark [1]
[TIME] 192 vertices, 2011136 cycles, 10474.666992 cycles/v
[INFO] Finished Catmull-Clark [2]
[TIME] 768 vertices, 516288 cycles, 672.250000 cycles/v
[INFO] Finished Catmull-Clark [3]
[TIME] 3072 vertices, 1513440 cycles, 492.656250 cycles/v
[INFO] Finished Catmull-Clark [4]
[TIME] 12288 vertices, 5818208 cycles, 473.486969 cycles/v
[INFO] Finished Catmull-Clark [5]
[TIME] 49152 vertices, 23412448 cycles, 476.327484 cycles/v
[INFO] Finished Catmull-Clark [6]
[TIME] 196608 vertices, 48748064 cycles, 247.945480 cycles/v
[INFO] Finished Catmull-Clark [7]
[TIME] 786432 vertices, 185788352 cycles, 236.242111 cycles/v
[INFO] Finished Catmull-Clark [8]
[TIME] 3145728 vertices, 726217952 cycles, 230.858475 cycles/v
~~~